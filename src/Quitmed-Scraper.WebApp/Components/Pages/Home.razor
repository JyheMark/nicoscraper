@page "/"
@using Microsoft.EntityFrameworkCore
@using Quitmed_scraper.Database
@inject QuitmedScraperDatabaseContext DatabaseContext

<MudText Typo="Typo.h2">Dispensaries</MudText>
@if (_dispensaries != null)
{
    <MudStack>
        <MudTable Items="@_dispensaries">
            <HeaderContent>
                <MudTh>Name</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="Name">
                    <MudLink Href="@GetDispensaryLink(context)">@context.Name</MudLink>
                </MudTd>
            </RowTemplate>
        </MudTable>
    </MudStack>
}

@code
{
    private List<DB.Dispensary>? _dispensaries;

    protected override async Task OnInitializedAsync()
    {
        _dispensaries = await DatabaseContext.Dispensaries.ToListAsync();
    }

    private string GetDispensaryLink(DB.Dispensary dispensary)
    {
        return $"/dispensaries/{dispensary.Id}";
    }
}